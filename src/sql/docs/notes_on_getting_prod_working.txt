DETAIL:  Key (key)=(83822-0-1-0) already exists.
DETAIL:  Key (key)=(83912-0-3-0) already exists.

83822-0-1-0
83912-0-3-0



SELECT COUNT(*) FROM vout_address WHERE vout_id IN (SELECT vout_id FROM vout WHERE tx_id IN (SELECT tx_id FROM tx WHERE block_id >= 82000));
SELECT COUNT(*) FROM vout WHERE tx_id IN (SELECT tx_id FROM tx WHERE block_id >= 82000);
SELECT COUNT(*) FROM vin WHERE tx_id IN (SELECT tx_id FROM tx WHERE block_id >= 82000);
SELECT COUNT(*) FROM tx WHERE block_id >= 82000;
SELECT COUNT(*) FROM block WHERE block_id >= 82000;

DELETE FROM vout_address WHERE vout_id IN (SELECT vout_id FROM vout WHERE tx_id IN (SELECT tx_id FROM tx WHERE block_id >= 82000));
DELETE FROM vin WHERE tx_id IN (SELECT tx_id FROM tx WHERE block_id >= 82000);
DELETE FROM vout WHERE tx_id IN (SELECT tx_id FROM tx WHERE block_id >= 82000);
DELETE FROM tx WHERE block_id >= 82000;
DELETE FROM block WHERE block_id >= 82000;

DELETE FROM vout WHERE vout_id >= 4269941;

SELECT vout_id FROM vout WHERE vout_id >= 4269941;

SELECT COUNT(tx_id) FROM tx WHERE block_id = 82000;

DELETE FROM vout WHERE vout_id >= 4270041 AND vout_id <= 4275000;


BEGIN;
EXPLAIN ANALYZE DELETE FROM vout WHERE vout_id = 4270042;
ROLLBACK;

DROP both vout foreign key CONSTRAINTS.

    TABLE "vin" CONSTRAINT "vin_vout_id_fkey" FOREIGN KEY (vout_id) REFERENCES vout(vout_id)
    TABLE "vout_address" CONSTRAINT "vout_address_vout_id_fkey" FOREIGN KEY (vout_id) REFERENCES vout(vout_id)


ALTER TABLE "vin" DROP CONSTRAINT "vin_vout_id_fkey";
ALTER TABLE "vout_address" DROP CONSTRAINT "vout_address_vout_id_fkey";
ALTER TABLE "vin" DROP CONSTRAINT "vin_tx_id_fkey";
ALTER TABLE "vout" DROP CONSTRAINT "vout_tx_id_fkey";
ALTER TABLE "tx" DROP CONSTRAINT "tx_block_id_fkey";


DELETE FROM vout_address WHERE vout_id IN (SELECT vout_id FROM vout WHERE tx_id IN (SELECT tx_id FROM tx WHERE block_id IN (SELECT block_id FROM block WHERE height >= 83500)));
DELETE FROM vin WHERE tx_id IN (SELECT tx_id FROM tx WHERE block_id IN (SELECT block_id FROM block WHERE height >= 83500));
DELETE FROM vout WHERE tx_id IN (SELECT tx_id FROM tx WHERE block_id IN (SELECT block_id FROM block WHERE height >= 83500));
DELETE FROM tx WHERE block_id IN (SELECT block_id FROM block WHERE height >= 83500);
DELETE FROM block WHERE height >= 83500;


ALTER TABLE "vin" ADD CONSTRAINT "vin_vout_id_fkey" FOREIGN KEY (vout_id) REFERENCES vout (vout_id);
ALTER TABLE "vout_address" ADD CONSTRAINT "vout_address_vout_id_fkey" FOREIGN KEY (vout_id) REFERENCES vout(vout_id);
ALTER TABLE "vin" ADD CONSTRAINT "vin_tx_id_fkey" FOREIGN KEY (tx_id) REFERENCES tx (tx_id);
ALTER TABLE "vout" ADD CONSTRAINT "vout_tx_id_fkey" FOREIGN KEY (tx_id) REFERENCES tx (tx_id);
ALTER TABLE "tx" ADD CONSTRAINT "tx_block_id_fkey" FOREIGN KEY (block_id) REFERENCES block (block_id);
